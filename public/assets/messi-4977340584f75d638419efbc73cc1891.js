function Messi(s,t){var i=this;if(i.options=jQuery.extend({},Messi.prototype.options,t||{}),i.messi=jQuery(i.template),i.setContent(s),null==i.options.title)jQuery(".messi-titlebox",i.messi).remove();else{if(jQuery(".messi-title",i.messi).append(i.options.title),0===i.options.buttons.length&&!i.options.autoclose&&i.options.closeButton){var e=jQuery('<span class="messi-closebtn"></span>');e.bind("click",function(){i.hide()}),jQuery(".messi-titlebox",this.messi).prepend(e)}null!=i.options.titleClass&&jQuery(".messi-titlebox",this.messi).addClass(i.options.titleClass)}if(null!=i.options.width&&jQuery(".messi-box",i.messi).css("width",i.options.width),i.options.buttons.length>0)for(var o=0;o<i.options.buttons.length;o++){var n=i.options.buttons[o]["class"]?i.options.buttons[o]["class"]:"",l=jQuery('<div class="btnbox"><button class="btn '+n+'" href="#">'+i.options.buttons[o].label+"</button></div>").data("value",i.options.buttons[o].val);l.on("click","button",function(){var s=jQuery.data(this,"value"),t=null!=i.options.callback?function(){i.options.callback(s)}:null;i.hide(t)}),jQuery(".messi-actions",this.messi).append(l)}else jQuery(".messi-footbox",this.messi).remove();if(0===i.options.buttons.length&&null==i.options.title&&!i.options.autoclose&&i.options.closeButton){var e=jQuery('<span class="messi-closebtn"></span>');e.bind("click",function(){i.hide()}),jQuery(".messi-content",this.messi).prepend(e)}return i.modal=i.options.modal?jQuery('<div class="messi-modal"></div>').css({opacity:i.options.modalOpacity,width:jQuery(document).width(),height:jQuery(document).height(),"z-index":i.options.zIndex+jQuery(".messi").length}).appendTo(document.body):null,i.options.show&&i.show(),jQuery(window).bind("resize",function(){i.resize()}),null!=i.options.autoclose&&setTimeout(function(s){s.hide()},i.options.autoclose,this),i}Messi.prototype={options:{autoclose:null,buttons:[],callback:null,center:!0,closeButton:!0,height:"auto",title:null,titleClass:null,modal:!1,modalOpacity:.2,padding:"10px",show:!0,unload:!0,viewport:{top:"0px",left:"0px"},width:"500px",zIndex:99999},template:'<div class="messi"><div class="messi-box"><div class="messi-wrapper"><div class="messi-titlebox"><span class="messi-title"></span></div><div class="messi-content"></div><div class="messi-footbox"><div class="messi-actions"></div></div></div></div></div>',content:"<div></div>",visible:!1,setContent:function(s){jQuery(".messi-content",this.messi).css({padding:this.options.padding,height:this.options.height}).empty().append(s)},viewport:function(){return{top:(jQuery(window).height()-this.messi.height())/2+jQuery(window).scrollTop()+"px",left:(jQuery(window).width()-this.messi.width())/2+jQuery(window).scrollLeft()+"px"}},show:function(){this.visible||(this.options.modal&&null!=this.modal&&this.modal.show(),this.messi.appendTo(document.body),this.options.center&&(this.options.viewport=this.viewport(jQuery(".messi-box",this.messi))),this.messi.css({top:this.options.viewport.top,left:this.options.viewport.left,"z-index":this.options.zIndex+jQuery(".messi").length}).show().animate({opacity:1},300),this.visible=!0)},hide:function(s){if(this.visible){var t=this;return this.messi.animate({opacity:0},300,function(){t.options.modal&&null!=t.modal&&t.modal.remove(),t.messi.css({display:"none"}).remove(),t.visible=!1,s&&s.call(),t.options.unload&&t.unload()}),this}},resize:function(){this.options.modal&&jQuery(".messi-modal").css({width:jQuery(document).width(),height:jQuery(document).height()}),this.options.center&&(this.options.viewport=this.viewport(jQuery(".messi-box",this.messi)),this.messi.css({top:this.options.viewport.top,left:this.options.viewport.left}))},toggle:function(){return this[this.visible?"hide":"show"](),this},unload:function(){this.visible&&this.hide(),jQuery(window).unbind("resize",function(){this.resize()}),this.messi.remove()}},jQuery.extend(Messi,{alert:function(s,t,i){var e=[{id:"ok",label:"OK",val:"OK"}];return i=jQuery.extend({closeButton:!1,buttons:e,callback:function(){}},i||{},{show:!0,unload:!0,callback:t}),new Messi(s,i)},ask:function(s,t,i){var e=[{id:"yes",label:"Yes",val:"Y","class":"btn-success"},{id:"no",label:"No",val:"N","class":"btn-danger"}];return i=jQuery.extend({closeButton:!1,modal:!0,buttons:e,callback:function(){}},i||{},{show:!0,unload:!0,callback:t}),new Messi(s,i)},img:function(s,t){var i=new Image;jQuery(i).load(function(){var s={width:jQuery(window).width()-50,height:jQuery(window).height()-50},e=this.width>s.width||this.height>s.height?Math.min(s.width/this.width,s.height/this.height):1;jQuery(i).css({width:this.width*e,height:this.height*e}),t=jQuery.extend(t||{},{show:!0,unload:!0,closeButton:!0,width:this.width*e,height:this.height*e,padding:0}),new Messi(i,t)}).error(function(){console.log("Error loading "+s)}).attr("src",s)},load:function(s,t){t=jQuery.extend(t||{},{show:!0,unload:!0,params:{}});var i={url:s,data:t.params,dataType:"html",cache:!1,error:function(s){console.log(s.responseText)},success:function(s){new Messi(s,t)}};jQuery.ajax(i)}});